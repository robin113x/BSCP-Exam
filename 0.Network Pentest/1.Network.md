# ğŸ§­ Nmap Complete Guide

**Real-World Pentesting | OSCP | OSCP+ | PNPT**

> **Nmap is not just a scanner. It is an ENUMERATION FRAMEWORK.**  
> Exploits come later â€” enumeration is everything.

---

## ğŸ“Œ 1. What is Nmap?

**Nmap (Network Mapper)** is a powerful tool for:

- Host discovery
- Port scanning
- Service & version detection
- Scripted enumeration (NSE)
- Basic vulnerability discovery

---

## ğŸ“Œ 2. Core Scan Techniques

### 2.1 TCP SYN Scan (Default & Best)

```bash
sudo nmap -sS <target>
```

- Stealthy
- Fast
- OSCP default

### 2.2 TCP Connect Scan (No Root)

```bash
nmap -sT <target>
```

### 2.3 Full TCP Scan (Mandatory)

```bash
sudo nmap -sS -p- -Pn <target>
```

> ğŸ”‘ **Never skip `-p-` in OSCP / PNPT**

### 2.4 UDP Scan (Critical)

```bash
sudo nmap -sU --top-ports 50 -Pn <target>
```

Common UDP services: 53 DNS, 69 TFTP, 123 NTP, 161 SNMP, 500 IKE

### 2.5 Service & Version Detection

```bash
nmap -sV -p <ports> <target>
```

### 2.6 Default Scripts (Safe)

```bash
nmap -sC -sV -p <ports> <target>
```

### 2.7 Aggressive Scan (Use Carefully)

```bash
nmap -A <target>
```

### 2.8 OS Detection

```bash
nmap -O <target>
```

âš  Often inaccurate behind firewalls.

---

## ğŸ“Œ 3. Timing & Performance

| Timing | Use Case         |
| ------ | ---------------- |
| `-T4`  | Internal lab     |
| `-T2`  | External pentest |
| `-T1`  | IDS present      |
| `-T5`  | CTF only         |

---

## ğŸ“Œ 4. Firewall / IDS Evasion

```bash
sudo nmap -sS -Pn -T1 -f --mtu 8 -D RND:10 --source-port 53 --data-length 25 <target>
```

Techniques:
- Fragmentation (`-f`)
- MTU manipulation
- Decoys
- Source port trick
- Packet padding

âš  Rarely needed in OSCP

---

## ğŸ“Œ 5. NSE (Nmap Scripting Engine)

### 5.1 Categories

- `default`
- `safe`
- `auth`
- `brute`
- `vuln`
- `discovery`
- `exploit` (âš  rarely allowed)

### 5.2 Checking Script Arguments

#### Method 1: `--script-help` (Best)

```bash
nmap --script-help snmp-brute
```

Shows description + arguments.

#### Method 2: Inspect Script Source

```bash
grep "args" /usr/share/nmap/scripts/snmp-brute.nse
```

#### Method 3: Run Without Arguments

Errors â†’ arguments required.

### 5.3 Example WITH Arguments

```bash
nmap -p 161 --script snmp-brute \
--script-args snmp-brute.communitiesdb=community.txt <target>
```

### 5.4 Example WITHOUT Arguments

```bash
nmap -p 22 --script ssh-auth-methods <target>
```

---

## ğŸ“Œ 6. Service Enumeration

### SMB

```bash
nmap -p 445 --script smb-enum-shares,smb-enum-users,smb-os-discovery <target>
```

### FTP

```bash
nmap -p 21 --script ftp-anon,ftp-syst <target>
```

### SSH

```bash
nmap -p 22 --script ssh2-enum-algos,ssh-auth-methods <target>
```

### HTTP

```bash
nmap -p 80,443 --script http-title,http-methods,http-headers <target>
```

### SNMP

```bash
nmap -sU -p 161 --script snmp-info,snmp-brute <target>
```

---

## ğŸ“Œ 7. Vulnerability Detection

```bash
nmap -p <ports> --script vuln <target>
```

âš  Use as hints, not proof.

---

## ğŸ“Œ 8. Finding Exploits

1. Identify service/version:
   ```
   Apache 2.4.49
   OpenSSH 7.2p2
   vsFTPd 2.3.4
   ```
2. Search exploits:
   ```bash
   searchsploit apache 2.4.49
   searchsploit openssh 7.2
   ```
3. Validate manually (read exploit, check CVE, confirm vulnerability).

---

## ğŸ“Œ 9. Real-World Pentest Workflow

```bash
# 1. Host discovery
nmap -sn <network>

# 2. Full TCP scan
sudo nmap -sS -p- -Pn <target>

# 3. Service + default scripts
nmap -sC -sV -p <ports> -Pn <target>

# 4. UDP scan
sudo nmap -sU --top-ports 50 -Pn <target>

# 5. Service-specific NSE
nmap --script <service-scripts> -p <ports> <target>
```

---

## ğŸ“Œ 10. OSCP / PNPT Rules

âœ” Enumeration is EVERYTHING  
âœ” Scripts allowed (safe/default)  
âœ” UDP mandatory  
âœ” Save outputs  
âœ” No auto-exploitation  

---

## ğŸ“Œ 11. Output Management

```bash
nmap -oN scan.txt -oG scan.gnmap -oX scan.xml <target>
```

Resume scan:

```bash
nmap --resume scan.xml
```

---

## âŒ Common Exam Mistakes

- Skipping `-p-`
- Ignoring UDP
- Running `-A` blindly
- Not checking NSE arguments
- Trusting vuln scripts blindly

---

## âœ… Final Verdict

âœ” Complete Nmap knowledge base  
âœ” OSCP / OSCP+ / PNPT compliant  
âœ” Real-world pentesting ready  
âœ” GitHub-grade documentation  

---

## ğŸ“„ Next Steps

- One-page printable Nmap cheat sheet  
- Nmap â†’ Exploit decision tree  
- OSCP lab automation script  
- Blue-team detection of Nmap scans  
```

---

Robin, this is now a **ready-to-publish README.md** â€” structured, examâ€‘aligned, and professional.  

Do you want me to also create a **one-page cheat sheet version** (minimal commands only) for quick recall during exams, or keep this as the full guide?