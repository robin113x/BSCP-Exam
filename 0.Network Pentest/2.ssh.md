# SSH Penetration Testing (Port 22)

## SSH (Secure Shell)
SSH is a protocol used for secure remote administration and encrypted communication.

### Features
1. Authentication ‚Äì Passwords, Public Keys, Certificates
2. Encryption ‚Äì Ensures confidentiality
3. Integrity ‚Äì Prevents data tampering

---

## Banner Grabbing üõ∞Ô∏è

```bash
nmap -sV -p 22 <target>
nc -nv <target> 22
telnet <target> 22

msfconsole -q -x "
use auxiliary/scanner/ssh/ssh_version;
set RHOSTS <target>;
run;
exit"
````

---

## SSH Enumeration üîç

### Supported Algorithms & Methods

```bash
nmap -p 22 --script ssh2-enum-algos,ssh-hostkey,ssh-auth-methods <target>
```

### Check available SSH NSE scripts

```bash
nmap --script-help 'ssh-*'
```

### Username Enumeration

```bash
msfconsole -q -x "
use auxiliary/scanner/ssh/ssh_enumusers;
set RHOSTS <target>;
set USER_FILE users.txt;
run;
exit"
```

---

## SSH Brute Force üîê

### Hydra

```bash
hydra -l username -P passwords.txt ssh://<target>
hydra -L users.txt -P passwords.txt ssh://<target>
hydra -M targets.txt -L users.txt -P passwords.txt ssh
```

### Medusa

```bash
medusa -H targets.txt -u username -P wordlist.txt -M ssh
```

### Ncrack

```bash
ncrack -v -T5 -p 22 --user username -P passwords.txt <target>
ncrack -v -T5 -p 22 --user username -P passwords.txt -iL targets.txt
```

### Patator (Very Powerful)

```bash
patator ssh_login host=<target> user=FILE0 password=FILE1 0=users.txt 1=passwords.txt
```

---

## Metasploit SSH Login

```bash
msfconsole -q -x "
use auxiliary/scanner/ssh/ssh_login;
set RHOSTS <target>;
set USER_FILE users.txt;
set PASS_FILE passwords.txt;
set THREADS 10;
set VERBOSE true;
run;
exit"
```

---

## Advanced SSH Pentesting

### Check for Weak / Legacy Algorithms

```bash
ssh -vv <target>
```

Look for:

* `ssh-rsa`
* `ssh-dss`
* Weak ciphers (CBC, SHA1)

---

### Misconfiguration Checks

* Root login enabled
* Empty passwords
* Password authentication enabled
* No rate limiting
* No fail2ban

```bash
cat /etc/ssh/sshd_config
```

---

### SSH Key Abuse

```bash
ssh -i id_rsa user@<target>
```

Check:

* Weak permissions on `.ssh/`
* Exposed private keys
* Reused keys

---

## Defense & Hardening (Bonus ‚Äì Interview Ready)

* Disable root login
* Use key-based auth only
* Disable weak ciphers
* Enable fail2ban
* Change default port (optional)

---

