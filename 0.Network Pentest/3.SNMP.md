# SNMP Penetration Testing

## SNMP (Simple Network Management Protocol)

- **Ports:**  
  - 161/UDP (queries) This port is used for normal SNMP communication, where a management system asks a device for information.
	- ‚úî What happens on port 161?
		- SNMP Manager ‚Üí sends GET, GETNEXT, GETBULK, SET requests
		- SNMP Agent (router/switch/server) ‚Üí responds back with the requested data . Ex ‚ÄúWhat is your hostname?‚Äù  
  - 162/UDP (traps) This port is used by devices to send alerts / notifications to the SNMP manager without being asked.	
  	- ‚úî What happens on port 162?
			- SNMP Agent ‚Üí sends Trap messages to the SNMP Manager
			- These traps notify about important events instantly. Interface goes down/ High CPU usage
- **Purpose:** Network monitoring & device management
- **Common Devices:** Routers, switches, printers, servers, firewalls, UPS systems
- **Weakness:** SNMPv1/v2c use plaintext community strings (e.g., `public`, `private`)


161/UDP	SNMP	Manager ‚Üí Device	Queries (GET/SET)
162/UDP	SNMP-Trap	Device ‚Üí Manager	Alerts / Notifications


## SNMP Overview
- 161/UDP ‚Üí Queries (GET / SET)
- 162/UDP ‚Üí Traps (Alerts)
- SNMPv1/v2c ‚Üí Plaintext community strings
- SNMPv3 ‚Üí Secure (Auth + Encryption)

---

## Nmap Discovery & Detection

### Check if SNMP is Open
```bash
nmap -sU -p 161,162 -Pn <target>
````

### Service Detection

```bash
nmap -sU -p 161 -sV -Pn <target>
```

---

## Nmap SNMP Enumeration Scripts üîç

### General SNMP Enumeration

```bash
nmap -sU -p 161 -Pn --script snmp-enum <target>
```

### System Information

```bash
nmap -sU -p 161 -Pn --script snmp-info <target>
```

### Interfaces & Network Info

```bash
nmap -sU -p 161 -Pn --script snmp-interfaces,snmp-netstat <target>
```

### Running Processes

```bash
nmap -sU -p 161 -Pn --script snmp-processes <target>
```

---

## Community String Brute Force (Nmap)

```bash
nmap -sU -p 161 -Pn --script snmp-brute --script-args snmp-brute.communitiesdb=community.txt <target>
```

---

## Windows-Specific SNMP Enumeration (If Applicable)

```bash
nmap -sU -p 161 -Pn --script snmp-win32-users,snmp-win32-services,snmp-win32-software <target>
```

---

## Reliable UDP Scanning (Important)

```bash
nmap -sU -p 161 -Pn \
--max-retries 3 \
--host-timeout 30s \
--defeat-icmp-ratelimit \
<target>
```

---

## SNMPv3 Detection (Security Check)

```bash
nmap -sU -p 161 --script snmp-info <target>
```

If output shows **SNMPv3**, brute force is usually **not feasible**.

---

## Post-Nmap Exploitation (After Community Found)

> These are **outside Nmap**, but required in real pentests

```bash
snmpwalk -v2c -c <community> <target>
snmpset -v2c -c private <target> sysName.0 s "HackedDevice"
```

---

## Final Verdict üéØ

### Is it perfect for Nmap?

‚ùå **Not originally**

### After applying fixes above?

‚úÖ **YES ‚Äì professional, interview-ready, real-world accurate**

### Your original content is best described as:

> **‚ÄúSNMP Pentesting Guide (Nmap + Native Tools)‚Äù**

‚Äînot **pure Nmap**.

---

If you want, I can:

* Convert this into **Nmap-only cheat sheet**
* Create **one-page SNMP attack flow**
* Add **blue-team detection & defense**
* Align it with **CEH / OSCP / PNPT**

Just say üëç
