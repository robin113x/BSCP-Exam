# SNMP Penetration Testing (Ports 161 / 162)


- **Ports**
  - **161/UDP ‚Äì Queries**
    - SNMP Manager ‚Üí Agent
    - GET, GETNEXT, GETBULK, SET requests
  - **162/UDP ‚Äì Traps**
    - Agent ‚Üí Manager
    - Unsolicited alerts (interface down, high CPU, reboot, etc.)

- **Purpose**: Network monitoring & device management
- **Common Devices**: Routers, switches, firewalls, servers, printers, UPS
- **Weakness**:
  - SNMPv1 / SNMPv2c ‚Üí **plaintext community strings**
  - Common defaults: `public` (RO), `private` (RW)

---

## Port Summary

| Port | Protocol | Direction | Description |
|-----|--------|----------|------------|
| 161/UDP | SNMP | Manager ‚Üí Device | Queries (GET / SET) |
| 162/UDP | SNMP-Trap | Device ‚Üí Manager | Alerts / Notifications |

---

## 1. Reconnaissance (Nmap)

### Detect SNMP Service
```bash
nmap -sU -p 161,162 -Pn <target>



## SNMP Overview
- 161/UDP ‚Üí Queries (GET / SET)
- 162/UDP ‚Üí Traps (Alerts)
- SNMPv1/v2c ‚Üí Plaintext community strings
- SNMPv3 ‚Üí Secure (Auth + Encryption)

---

## Nmap Discovery & Detection

### Check if SNMP is Open
```bash
nmap -sU -p 161,162 -Pn <target>
````

### Service Detection

```bash
nmap -sU -p 161 -sV -Pn <target>
```

---

## Nmap SNMP Enumeration Scripts üîç

### General SNMP Enumeration

```bash
nmap -sU -p 161 -Pn --script snmp-enum <target>
```

### System Information

```bash
nmap -sU -p 161 -Pn --script snmp-info <target>
```

### Interfaces & Network Info

```bash
nmap -sU -p 161 -Pn --script snmp-interfaces,snmp-netstat <target>
```

### Running Processes

```bash
nmap -sU -p 161 -Pn --script snmp-processes <target>
```

---

## Community String Brute Force (Nmap)

```bash
nmap -sU -p 161 -Pn --script snmp-brute --script-args snmp-brute.communitiesdb=community.txt <target>
```

---

## Windows-Specific SNMP Enumeration (If Applicable)

```bash
nmap -sU -p 161 -Pn --script snmp-win32-users,snmp-win32-services,snmp-win32-software <target>
```

---

## Reliable UDP Scanning (Important)

```bash
nmap -sU -p 161 -Pn --max-retries 3 --host-timeout 30s --defeat-icmp-ratelimit <target>
```

---

## SNMPv3 Detection (Security Check)

```bash
nmap -sU -p 161 --script snmp-info <target>
```

If output shows **SNMPv3**, brute force is usually **not feasible**.

---

## Post-Nmap Exploitation (After Community Found)

```bash
snmpwalk -v2c -c <community> <target>
snmpset -v2c -c private <target> sysName.0 s "HackedDevice"
```

---

