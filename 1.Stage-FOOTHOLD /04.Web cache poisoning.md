# Web cache poisoning
https://0a270004048ee78780dd6758004400ae.web-security-academy.net/





# üõ° Web Cache Poisoning

## 1Ô∏è‚É£ What is Web Cache Poisoning?
**Web cache poisoning** is an attack where an attacker manipulates a web server‚Äôs cache to store a **malicious HTTP response**.  
When other users request the same resource, they receive the **poisoned (malicious) response** instead of the intended one.

The attacker‚Äôs goal: **Serve malicious content to many users** via the cache without directly targeting each one.

---

## 2Ô∏è‚É£ How Does a Web Cache Work?
A **web cache** stores HTTP responses so that future requests for the same resource can be served quickly without re-fetching from the origin server.  
Types of caches:
- **Browser Cache** ‚Äì Stored on the client side.
- **CDN / Reverse Proxy Cache** ‚Äì Stored at network level (e.g., Cloudflare, Akamai).
- **Server Cache** ‚Äì Stored on the web server.

**Basic process:**
1. Client sends HTTP request.
2. Cache checks if a valid cached copy exists.
3. If yes ‚Üí serve cached response.  
   If no ‚Üí forward request to server ‚Üí store server‚Äôs response in cache ‚Üí serve to client.

---

## 3Ô∏è‚É£ Impact of a Web Cache Poisoning Attack
- **Widespread XSS** ‚Äì Inject JavaScript into cached responses.
- **Defacement** ‚Äì Alter content displayed to all users.
- **Phishing** ‚Äì Redirect cached pages to malicious sites.
- **Credential Theft** ‚Äì Inject scripts to steal cookies/session tokens.
- **Service Disruption** ‚Äì Deliver broken or malicious responses to legitimate users.

---

## 4Ô∏è‚É£ Constructing a Web Cache Poisoning Attack

### Step 1: Identify and Evaluate Unkeyed Inputs
- **Unkeyed inputs** are parts of the HTTP request that affect the response **but are not part of the cache key**.
- Example: HTTP headers like `X-Forwarded-Host` or query parameters ignored by the cache.
- **Why it matters:** If the cache ignores an input but the server processes it, you can control the cached output.

---

### Step 2: Param Miner
- Use **Burp Suite‚Äôs Param Miner extension** to automatically guess:
  - Hidden parameters
  - Non-standard HTTP headers
  - Inputs that may influence server behavior but not the cache key.
- This helps find cache poisoning vectors.

---

### Step 3: Elicit a Harmful Response from the Back-End Server
- Manipulate the unkeyed input to:
  - Trigger **JavaScript injection** (for XSS)
  - Add **malicious redirects**
  - Alter HTML responses
- Example:
  ```http
  GET / HTTP/1.1
  Host: victim.com
  X-Forwarded-Host: attacker.com
  ```
- Possible payloads:
	- Inject HTML/JS (<script>alert(1)</script>)
	- Change redirect URLs
	- Alter API responses


