# HTTP Host header attacks

## 🔹 What is the HTTP Host header?
- When you type a website like https://example.com into your browser, your browser sends a request to the server.   - But here’s the thing:
     - Many websites share the same IP address (like apartments in a single building).
     - The Host header in HTTP is basically the part of the request that says “Hey server, I want the website example.com, not the other sites living on the same IP.”
     - 👉 Example:
     ```bash 
     GET /index.html HTTP/1.1
     Host: example.com
    ```
    - This tells the server, “Please give me the homepage of example.com.”

## 🔹 What is the purpose of the HTTP Host header?
- Its main purpose is virtual hosting.
- Since multiple websites can run on one server (same IP), the Host header makes sure the server knows which website you actually want.

Without it, the server would be confused about which site’s content to send you.

👉 Think of it like telling a receptionist in a big office building “I’m here to see the Marketing Department (Host: example.com)” instead of just walking in blindly.

🔹 How does the Host header solve this problem?

Imagine one IP = one big apartment building.

Each flat = one website.

When you arrive, you must tell the guard which flat (website) you’re visiting.

That’s exactly what the Host header does — it guides the server to the right “flat” (site) inside a shared “building” (IP).

🔹 What is an HTTP Host header attack?

Here’s where things get interesting 😈.
If the application trusts the Host header too much, an attacker can tamper with it to trick the website into doing dangerous things.

👉 Example attack:

GET /reset-password HTTP/1.1
Host: attacker.com


If the site uses the Host header to build password reset links, the victim might receive a link like:

http://attacker.com/reset?token=12345


😱 Now the victim thinks it’s safe, but the attacker gets the reset link on their domain!

🔹 How do Host header vulnerabilities arise?

They happen when developers don’t validate the Host header properly and just trust it blindly.
Some risky places:

Password reset links (in emails)

Absolute URLs in redirects

Caching mechanisms

Security filters / firewalls

If the Host header is manipulated, it can:

Point users to malicious sites

Poison caches (cache poisoning)

Bypass security checks

🔹 Exploiting Host header vulnerabilities

Attackers can use this in different ways:

Password reset poisoning – Hijacking reset links sent to users.

Web cache poisoning – Serving malicious content to many users by tricking the cache.

SSRF (Server-Side Request Forgery) – Forcing the server to make requests to internal systems.

Bypassing access controls – If the app checks “Host” to allow/deny requests, attackers can fake it.

✅ In human words:

Host header = the “address label” telling the server which website you want.

Purpose = makes shared hosting possible.

Problem solved = without it, servers wouldn’t know which site to show.

Attack = bad guys forge this label to trick the website.

Vulnerability cause = developers trusting user input (Host header) without checking.

Exploitation = password reset hijack, cache poisoning, SSRF, phishing-style tricks.
 