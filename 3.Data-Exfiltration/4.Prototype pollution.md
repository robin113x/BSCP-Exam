# Prototype pollution


### Lab: Client-side prototype pollution via browser APIs

- Goal: Exploit client-side prototype pollution to trigger a DOM XSS (script.src) sink.
Manual approach
Find pollution source: Inject into query string /?__proto__[foo]=bar and verify Object.prototype.foo appears in the browser console.
Identify gadget: Inspect site scripts (Sources). In searchLoggerConfigurable.js a transport_url is dynamically appended as a <script> but was made non-writable/unconfigurable with Object.defineProperty() without defining a value property — this creates a gadget that reads value.
Exploit: Pollute prototype so the gadget picks up a value property: /?__proto__[value]=data:,alert(1); — the page renders <script src="data:,alert(1);"> and alert(1) runs, solving the lab.
DOM Invader (Burp) approach
Load lab in Burp browser, enable DOM Invader with prototype-pollution option.
Reload; DOM Invader finds prototype-pollution vectors in the query string.
Click Scan for gadgets → DOM Invader locates the value gadget and the script.src sink.
Click Exploit → DOM Invader auto-generates the POC and triggers alert(1).
Key takeaway: Prototype pollution via __proto__ can inject properties that interact with existing DOM-creating gadgets (e.g., script insertion) to achieve DOM XSS.